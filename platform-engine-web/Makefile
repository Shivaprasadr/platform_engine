# Platform Engine Web - Development Commands
# ==========================================
# Usage: make <command>
# Example: make dev-start

# ğŸš€ QUICK START COMMANDS
# ----------------------
dev-start:
	@echo "ğŸš€ Starting web app for development in background (with live reload)..."
	docker-compose up -d --build
	@echo "âœ… Web development started in background!"
	@echo "ğŸ“Š Next steps:"
	@echo "   â€¢ Check status: make dev-status"
	@echo "   â€¢ Follow logs: make dev-logs-live"
	@echo "   â€¢ Check container: make dev-shell"
	@echo "ğŸŒ Access: http://localhost:3000"

dev-foreground:
	@echo "ğŸš€ Starting web app for development with logs visible (with live reload)..."
	docker-compose up --build

dev-background:
	@echo "ğŸš€ Starting web app in background (with live reload)..."
	docker-compose up -d --build
	@echo "âœ… Web development started in background!"
	@echo "ğŸ“Š Next steps:"
	@echo "   â€¢ Check status: make dev-status"
	@echo "   â€¢ Follow logs: make dev-logs-live"

local-start:
	@echo "ğŸ  Starting web app locally (without Docker)..."
	yarn run dev --port 3000

# ğŸ“¦ SETUP COMMANDS
# ----------------
install-deps:
	@echo "ğŸ“¦ Installing project dependencies..."
	yarn install

setup-project:
	@echo "âš™ï¸ Setting up project (install deps + build)..."
	yarn install
	yarn build

# ğŸ” CODE QUALITY COMMANDS
# ------------------------
check-code:
	@echo "ğŸ” Checking code quality (linting)..."
	yarn lint

format-code:
	@echo "âœ¨ Formatting code..."
	yarn format

check-format:
	@echo "ğŸ” Checking if code is properly formatted..."
	yarn format-check

build-app:
	@echo "ğŸ—ï¸ Building application for production..."
	yarn build

# ğŸ”§ DEVELOPMENT TOOLS
# -------------------
dev-logs:
	@echo "ğŸ“‹ Showing development logs..."
	docker-compose logs

dev-logs-live:
	@echo "ğŸ“‹ Following development logs (Ctrl+C to stop)..."
	docker-compose logs -f

dev-status:
	@echo "ğŸ“Š Checking development container status..."
	docker-compose ps

dev-shell:
	@echo "ğŸš Opening shell inside development container..."
	docker-compose exec react-app sh

# ğŸ”„ RESTART & RELOAD COMMANDS
# ---------------------------
dev-restart:
	@echo "ğŸ”„ Restarting development container..."
	docker-compose restart

dev-rebuild:
	@echo "ğŸ”¨ Rebuilding development container in background (when package.json changes)..."
	docker-compose build --no-cache
	docker-compose up -d
	@echo "âœ… Web development rebuilt and started in background!"
	@echo "ğŸ“Š Next steps:"
	@echo "   â€¢ Check status: make dev-status"
	@echo "   â€¢ Follow logs: make dev-logs-live"

dev-stop:
	@echo "ğŸ›‘ Stopping development container..."
	docker-compose down

# ğŸ§¹ CLEANUP COMMANDS
# ------------------
dev-clean:
	@echo "ğŸ§¹ Cleaning up and restarting fresh in background..."
	docker-compose down --volumes --remove-orphans
	docker-compose up -d --build
	@echo "âœ… Web development restarted clean in background!"
	@echo "ğŸ“Š Next steps:"
	@echo "   â€¢ Check status: make dev-status"
	@echo "   â€¢ Follow logs: make dev-logs-live"

dev-reset:
	@echo "ğŸ”„ Complete reset in background (clean everything and start fresh)..."
	docker-compose down --volumes --remove-orphans
	docker-compose build --no-cache
	docker-compose up -d
	@echo "âœ… Web development reset complete in background!"
	@echo "ğŸ“Š Next steps:"
	@echo "   â€¢ Check status: make dev-status"
	@echo "   â€¢ Follow logs: make dev-logs-live"

# ğŸ“š HELP COMMAND
# --------------
web-help:
	@echo ""
	@echo "ğŸŒ Platform Engine Web - Available Commands"
	@echo "============================================"
	@echo ""
	@echo "ğŸš€ QUICK START:"
	@echo "  dev-start      - Start development in background (live reload)"
	@echo "  dev-foreground - Start development with logs visible"
	@echo "  dev-background - Start development in background (alias)"
	@echo "  local-start    - Start locally without Docker"
	@echo ""
	@echo "ğŸ“¦ SETUP:"
	@echo "  install-deps   - Install project dependencies"
	@echo "  setup-project  - Complete project setup"
	@echo ""
	@echo "ğŸ” CODE QUALITY:"
	@echo "  check-code     - Run linting checks"
	@echo "  format-code    - Format all code"
	@echo "  build-app      - Build for production"
	@echo ""
	@echo "ğŸ”§ DEVELOPMENT TOOLS:"
	@echo "  dev-logs       - Show container logs"
	@echo "  dev-logs-live  - Follow logs in real-time"
	@echo "  dev-status     - Check container status"
	@echo "  dev-shell      - Open shell in container"
	@echo ""
	@echo "ğŸ”„ RESTART & RELOAD:"
	@echo "  dev-restart    - Restart container"
	@echo "  dev-rebuild    - Rebuild container (for package changes)"
	@echo "  dev-stop       - Stop development"
	@echo ""
	@echo "ğŸ§¹ CLEANUP:"
	@echo "  dev-clean      - Clean restart"
	@echo "  dev-reset      - Complete reset"
	@echo ""
	@echo "ğŸ’¡ COMMON SCENARIOS:"
	@echo "  Starting work:        make dev-start (runs in background)"
	@echo "  Code changes:         (automatic reload)"
	@echo "  Package changes:      make dev-rebuild"
	@echo "  Container issues:     make dev-clean"
	@echo "  Fresh start:          make dev-reset"
	@echo "  See logs:             make dev-logs-live"
	@echo ""
	@echo "ğŸ’¡ NOTE: dev-start runs in BACKGROUND by default!"
	@echo "         Use dev-foreground to see logs in terminal"
	@echo ""
	@echo "ğŸŒ Access: http://localhost:3000"
